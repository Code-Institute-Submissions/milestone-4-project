{% extends 'base.html' %}
{% block content %}

<h3>Edit Task!</h3>

<div class="box">
  <div class="card">
    <div class="card-header">
      <div class="row">
        <form class="col s12" action="{{url_for('update_appointment', app_id=appointment._id, user_id = user_id)}}"
          method="POST">
          <div class="card-header col s12" id="headingOne">

            <!-- Confirm the name of the department from the name of available departments -->

            <div class="row">
              <div class="input-field col s12">
                <i class="far fa-address-book prefix"></i>
                <label for="dept_name">Department Name :</label>
                <select id="departments" name="dept_name" class="form-control validate">
                  <option value="" class="dept" disabled selected>Choose a department</option>
                  {% for dept in departments %}
                  {% if dept.dept_name == appointment.dept_name %}
                  <option value="{{ dept.dept_name }}" selected>{{ dept.dept_name }}</option>
                  {% else %}
                  <option value="{{ dept.dept_name }}">{{ dept.dept_name }}</option>
                  {% endif %}
                  {% endfor %}
                </select>
              </div>
            </div><br />

            <!-- Confirm the name of the service from the list of available services -->

            <div class="row">
              <div class="input-field col s12">
                <i class="fas fa-cogs prefix"></i>
                <label for="service">Service</label>
                <select id="service" name="service" class="form-control validate">
                  <option id="service" value="{{ appointment.service }}" selected>{{ appointment.service }}</option>
                </select>
              </div>
            </div><br />

            <!-- Edit task name -->

            <div class="row">
              <div class="input-field col s12">
                <i class="far fa-address-card"></i>
                <label for="icon_prefix">Appointment Name</label>
                <input id="task_name" name="task_name" type="text" class="form-control validate" placeholder="Patient's name"
                  value="{{ appointment.task_name }}">
              </div>
            </div><br />

            <!-- Edit task description name -->

            <div class="row">
              <div class="input-field col s12">
                <i class="fas fa-pencil-alt"></i>
                <label for="task_description">Appointment Description</label>
                <textarea name="task_description" id="task_description" class="form-control validate" type="text"
                  placeholder="Add appointment description here" data-toggle="tooltip" data-placement="top" title="Give a brief description please"
                  required>{{ appointment.task_description }}</textarea>
              </div>
            </div><br />

            <!-- Edit employee name -->

            <div class="row">
              <div class="input-field col s12">
                <i class="far fa-user-circle"></i>
                <label for="user_name">Created By</label>
                <input name="user_name" id="uder_name" class="form-control validate" placeholder="Add your name here"
                  value="{{ session.user }}" data-toggle="tooltip" data-placement="top" title="Your name is automatically added here"
                  disabled required />
              </div>
            </div><br />

            <!-- Edit Date/Time Picker -->

            <div class="row">
              <div class="col-sm-6">
                <i class="far fa-clock"></i>
                <label for="date_time">Appointment Date/Time</label>
                <div class="form-group">
                  <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                    <input name="date_time" id="date_time" type="text" class="form-control datetimepicker-input" value="{{ appointment.date_time }}"
                      data-target="#datetimepicker1" placeholder="dd-mm-yyyy hh:mm" required />
                    <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                      <div class="input-group-text"><i class="far fa-calendar-alt"></i></div>
                    </div>
                  </div>
                </div>
              </div>
            </div><br />

            <!-- Edit Task Urgency Selector -->

            <div class="row">
              <h5 class="col-md-4">
                <label>
                  {% if appointment.is_urgent %}
                  <input id="toggle-one" name="is_urgent" type="checkbox" checked data-toggle="toggle" data-on="<span class='fa-urgent'><i class='fas fa-exclamation-circle'></i></span> Urgent"
                    data-off="<span class='fa-success'><i class='fas fa-check-circle'></i></span> Normal" data-onstyle="outline-secondary"
                    data-offstyle="outline-success" data-style="border" data-size="sm" data-width="115">
                  {% else %}

                  <input id="toggle-one" name="is_urgent" type="checkbox" data-toggle="toggle" data-on="<span class='fa-urgent'><i class='fas fa-exclamation-circle'></i></span> Urgent"
                    data-off="<span class='fa-success'><i class='fas fa-check-circle'></i></span> Normal" data-onstyle="outline-secondary"
                    data-offstyle="outline-success" data-style="border" data-size="sm" data-width="115">
                  {% endif %}

                </label>
              </h5>
            </div>

            <!-- Task Archived Selector -->

            <div class="row">
              <h5 class="col-md-4">
                <label>
                  {% if appointment.is_archived %}
                  <input id="toggle-one" name="is_archived" type="checkbox" data-toggle="toggle" data-on="<span class='fa-primary'><i class='fas fa-check-circle'></i></span> Complete"
                    data-off="<span class='fa-warning'><i class='fas fa-clock'></i></span> Pending" data-onstyle="outline-success"
                    data-offstyle="outline-secondary" data-style="border" data-size="sm" data-width="115">
                  {% else %}

                  <input id="toggle-one" name="is_archived" type="checkbox" data-toggle="toggle" data-on="<span class='fa-primary'><i class='fas fa-check-circle'></i></span> Complete"
                    data-off="<span class='fa-warning'><i class='fas fa-clock'></i></span> Pending" data-onstyle="outline-success"
                    data-offstyle="outline-success" data-style="border" data-size="sm" data-width="115">
                  {% endif %}

                </label>
              </h5>
            </div>
            <div class="row">
              <h5 class="col-md-4">
                <button class="btn btn-dark btn-sm" type="submit" name="action">Edit Task
                  <span class="fa-warning"><i class="fas fa-folder-plus"></i></span>
                </button>
                <a href="{{url_for('get_appointment')}}" class="btn btn-dark btn-sm">Cancel</a><br />
                <br />
                <a href="{{url_for('delete_appointment',  app_id=appointment._id, user_id = user_id)}}" 
                class="btn btn-secondary btn-sm confirm-delete">Delete <span class="fa-warning"><i class="fas fa-trash-alt"></i></span></a>
              </h5>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}